<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Deranged Pong</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@talkjs/web-components@0.0.27/default.css"
  />
  <script
    src="https://cdn.jsdelivr.net/npm/@talkjs/web-components@0.0.27"
    async
  ></script>
  <link rel="stylesheet" href="pong.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script type="module">
    import { getTalkSession } from 'https://cdn.jsdelivr.net/npm/@talkjs/core@1.5.8';
    let params = new URLSearchParams(document.location.search);
    let name = params.get("name");
    if (!name){
        let name = "Frank";

    }

    const appId = 'tKAe9pYx';

    const userId = name;
    console.log("USERID " + userId)
    const conversationId = 'my_conversation3';
    const conversation2Id = "test4";

    const session = getTalkSession({
        // @ts-ignore
        host: 'durhack.talkjs.com',
        appId,
        userId,
    });

    session.currentUser.createIfNotExists({ name: name });
    document.getElementById("dingus").userId = name;
    document.getElementById("dingus2").userId = name;

    document.getElementById("dingus").conversationId = conversationId;
    document.getElementById("dingus2").conversationId = conversation2Id;

    const conversation = session.conversation(conversationId);
    const conversation2 = session.conversation(conversation2Id);
    conversation.createIfNotExists();
    conversation2.createIfNotExists();

  </script>
</head>


<body>
  <audio id="myAudio" src="dingus.mp3"></audio>
  <audio id="winner" src="win31.mp3"></audio>

  <div id="ui">
    <h1>Deranged Pong</h1>
    <h4>First team to score 10 points wins.</h4>
    <button id="connectBtn">Join Game</button>
    <button id = "backBtn" class = "bg-danger">Back</button>
    <p id="status">Not connected</p>
  </div>
  <div>
    <div class="row text-center">
      <div class="col-2 rounded-3 ">
        <h4>Team 1</h4>

        <t-chatbox id = "dingus"
            host="durhack.talkjs.com"
            style="width: 240px; height: 400px;"
            app-id="tKAe9pYx"
            message-field-visible="false"
            chat-header-visible="false"
            >
        </t-chatbox>
        <form id = "form1" method="post" action = "">
            <input type = "text" id = "inp1" name = "inp1">
        </form>
      </div>

      <div class="col-8 rounded-3 ">
        <canvas id="game" width="800" height="480"></canvas>
      </div>

      <div class="col-2 rounded-3 ">
        <h4>Team 2</h4>
        <t-chatbox id = "dingus2"
            host="durhack.talkjs.com"
            style="width: 240px; height: 400px;"
            app-id="tKAe9pYx"
            message-field-visible="false"
            chat-header-visible="false"
            >
        </t-chatbox>
        <form id = "form2" method="post" action = "">
            <input type = "text" id = "inp2" name = "inp2">
        </form>
      </div>
    </div>
  </div>
  <script src="pong.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
